<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>NessieOcr: Preprocessor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Preprocessor Class Reference</h1><!-- doxytag: class="Preprocessor" --><a class="el" href="class_preprocessor.html" title="Preprocessor of the OCR process.">Preprocessor</a> of the OCR process.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_preprocessor_8hpp-source.html">Preprocessor.hpp</a>&gt;</code>
<p>
<div class="dynheader">
Collaboration diagram for Preprocessor:</div>
<div class="dynsection">
<p><center><img src="class_preprocessor__coll__graph.png" border="0" usemap="#_preprocessor__coll__map" alt="Collaboration graph"></center>
<map name="_preprocessor__coll__map">
<area shape="rect" href="class_preprocessor_statistics.html" title="Statistics gathered during the preprocessing stage of the text recognition process..." alt="" coords="99,7,296,521"><area shape="rect" href="class_clip.html" title="Press clip of a newspaper page." alt="" coords="461,145,608,383"></map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="class_preprocessor-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#d5bdc15c2c4ad5e638a82926fcaa45c1">Preprocessor</a> (const <a class="el" href="class_clip.html">Clip</a> &amp;pressClip)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#d5bdc15c2c4ad5e638a82926fcaa45c1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const std::list&lt; <a class="el" href="class_region.html">Region</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#36c183d9c8bf87ca5c6311db07e444a7">regions</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the regions found, if any, in the last segmentation process.  <a href="#36c183d9c8bf87ca5c6311db07e444a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="class_preprocessor_statistics.html">PreprocessorStatistics</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#760ecd922ae5ad557edcf5f3d9be2a19">statistics</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the statistics about the preprocessing stage.  <a href="#760ecd922ae5ad557edcf5f3d9be2a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#2e4497571f6c728efcbcaf34187958b1">applyAveragingFilters</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply an averaging filter mask (linear filtering) over the press clip to remove noise and smooth character borders.  <a href="#2e4497571f6c728efcbcaf34187958b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#3a751b1343980bbfd3337d962a8e7db3">applyGlobalThresholding</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a global thresholding algorithm over the press clip.  <a href="#3a751b1343980bbfd3337d962a8e7db3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#a223334c6c9fa84a15d9ad0808ce57cf">applyTemplateFilters</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply four 3x3 matching templates over the press clip to remove noise and smooth character borders.  <a href="#a223334c6c9fa84a15d9ad0808ce57cf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#c6c2bf889180380d459b90b32c726247">extractRegions</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a segmentation process over the press clip to isolate every region of ink pixels.  <a href="#c6c2bf889180380d459b90b32c726247"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#1be36c8dc2dc249cb7e896f9dbbffc3c">correctSlanting</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Correct the slanting of every region extracted from press clip.  <a href="#1be36c8dc2dc249cb7e896f9dbbffc3c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; unsigned int &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#de90e5448d726d11fcf126166ffa2e40">findSpacesBetweenWords</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scan the list of regions detecting the spaces between words.  <a href="#de90e5448d726d11fcf126166ffa2e40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const double &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_preprocessor.html#813eb754a76dc82aa994e2c6217b3ee0">averageCharacterHeight</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes the average character height.  <a href="#813eb754a76dc82aa994e2c6217b3ee0"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This class encapsulates all the algorithms related to the preprocessing stage of the OCR process. Its task is to extract the regions of interest from a press clip, enhance them and clean the result by smoothing and noise removal. In the very end of the process, a list of regions is available through the <a class="el" href="class_preprocessor.html#36c183d9c8bf87ca5c6311db07e444a7" title="Get the regions found, if any, in the last segmentation process.">Preprocessor::regions()</a> method.<p>
For an optimal preprocessing, it is strongly recommended that the following algorithms will be executed:<p>
<ol type=1>
<li>Smoothing and noise removal by averaging filters</li><li>Global gray level thresholding</li><li>Smoothing and noise removal by template filters</li><li>Patterns extraction and isolation</li><li>Slant detection and correction</li></ol>
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="class_clip.html" title="Press clip of a newspaper page.">Clip</a>, <a class="el" href="class_preprocessor_statistics.html" title="Statistics gathered during the preprocessing stage of the text recognition process...">PreprocessorStatistics</a>, <a class="el" href="class_region.html" title="Set of ink pixels that defines an isolated region in the press clip.">Region</a></dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Eliezer Tal√≥n (<a href="mailto:elitalon@gmail.com">elitalon@gmail.com</a>) </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2009-01-08 </dd></dl>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="d5bdc15c2c4ad5e638a82926fcaa45c1"></a><!-- doxytag: member="Preprocessor::Preprocessor" ref="d5bdc15c2c4ad5e638a82926fcaa45c1" args="(const Clip &amp;pressClip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Preprocessor::Preprocessor           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_clip.html">Clip</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pressClip</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pressClip</em>&nbsp;</td><td>A press clip over which apply all the preprocessing algorithms. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="2e4497571f6c728efcbcaf34187958b1"></a><!-- doxytag: member="Preprocessor::applyAveragingFilters" ref="2e4497571f6c728efcbcaf34187958b1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Preprocessor::applyAveragingFilters           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="pre" compact><dt><b>Precondition:</b></dt><dd>The press clip must be in grayscale mode.</dd></dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>The noise in the image is removed and the borders of characters are blurred. </dd></dl>

</div>
</div><p>
<a class="anchor" name="3a751b1343980bbfd3337d962a8e7db3"></a><!-- doxytag: member="Preprocessor::applyGlobalThresholding" ref="3a751b1343980bbfd3337d962a8e7db3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Preprocessor::applyGlobalThresholding           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The algorithm uses the Otsu's method to find automatically the optimal threshold for the press clip. Then, it compares each pixel gray level with that threshold and transforms the source clip into a binary image. As a result, the final histogram is bimodal. The algorithm also assumes that gray levels in the press clip above the threshold belong to the background, while gray levels below belong to the ink.<p>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>Every pixel in the press clip belonging to the background has a gray level value of 0, while every pixel of ink has a gray level of 1. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a223334c6c9fa84a15d9ad0808ce57cf"></a><!-- doxytag: member="Preprocessor::applyTemplateFilters" ref="a223334c6c9fa84a15d9ad0808ce57cf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Preprocessor::applyTemplateFilters           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="pre" compact><dt><b>Precondition:</b></dt><dd>The press clip must have been converted to binary mode, i.e. 0 for background pixels and 1 for ink pixels.</dd></dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>The noise in the image is removed and the borders of characters are smoothed. </dd></dl>

</div>
</div><p>
<a class="anchor" name="813eb754a76dc82aa994e2c6217b3ee0"></a><!-- doxytag: member="Preprocessor::averageCharacterHeight" ref="813eb754a76dc82aa994e2c6217b3ee0" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double &amp; Preprocessor::averageCharacterHeight           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The average character height in pixels. </dd></dl>

</div>
</div><p>
<a class="anchor" name="1be36c8dc2dc249cb7e896f9dbbffc3c"></a><!-- doxytag: member="Preprocessor::correctSlanting" ref="1be36c8dc2dc249cb7e896f9dbbffc3c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Preprocessor::correctSlanting           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="pre" compact><dt><b>Precondition:</b></dt><dd>The internal list of regions must have been initialized by calling <a class="el" href="class_preprocessor.html#c6c2bf889180380d459b90b32c726247" title="Apply a segmentation process over the press clip to isolate every region of ink pixels...">Preprocessor::extractRegions()</a>.</dd></dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>The regions that present slanting are rotated as much as possible to be aligned with the Y-axis. </dd></dl>

</div>
</div><p>
<a class="anchor" name="c6c2bf889180380d459b90b32c726247"></a><!-- doxytag: member="Preprocessor::extractRegions" ref="c6c2bf889180380d459b90b32c726247" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Preprocessor::extractRegions           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This method isolates every region of ink pixels in a press clip following a region flooding algorithm. Starting from an arbitrary pixel of ink, it connects its neighbouring ink pixels and builds a set of regions. This set is then post-processed to join accents and other punctuation signs to their final region. A final list is generated by sorting the set of regions by lines and columns, so that traversing the list forward is equivalent to reading the text from left to right and from up to down.<p>
<dl class="pre" compact><dt><b>Precondition:</b></dt><dd>The press clip must have been thresholded.</dd></dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>The internal members are set, so that a list of regions becomes available through <a class="el" href="class_preprocessor.html#36c183d9c8bf87ca5c6311db07e444a7" title="Get the regions found, if any, in the last segmentation process.">Preprocessor::regions()</a> method. </dd></dl>

</div>
</div><p>
<a class="anchor" name="de90e5448d726d11fcf126166ffa2e40"></a><!-- doxytag: member="Preprocessor::findSpacesBetweenWords" ref="de90e5448d726d11fcf126166ffa2e40" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; unsigned int &gt; Preprocessor::findSpacesBetweenWords           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An array of numbers, each one represents the position where a blank space must be inserted when building the text in further post-processing. </dd></dl>

</div>
</div><p>
<a class="anchor" name="36c183d9c8bf87ca5c6311db07e444a7"></a><!-- doxytag: member="Preprocessor::regions" ref="36c183d9c8bf87ca5c6311db07e444a7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::list&lt; <a class="el" href="class_region.html">Region</a> &gt; &amp; Preprocessor::regions           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A list of <a class="el" href="class_region.html" title="Set of ink pixels that defines an isolated region in the press clip.">Region</a> objects </dd></dl>

</div>
</div><p>
<a class="anchor" name="760ecd922ae5ad557edcf5f3d9be2a19"></a><!-- doxytag: member="Preprocessor::statistics" ref="760ecd922ae5ad557edcf5f3d9be2a19" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_preprocessor_statistics.html">PreprocessorStatistics</a> &amp; Preprocessor::statistics           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A <a class="el" href="class_preprocessor_statistics.html" title="Statistics gathered during the preprocessing stage of the text recognition process...">PreprocessorStatistics</a> object with all the statistics gathered. </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Mar 27 16:51:13 2009 for NessieOcr by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
